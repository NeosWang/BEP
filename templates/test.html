<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>JBP 000</title>
    <!-- STYLES -->


    <link rel="stylesheet" href="{{ url_for('static', filename='css/nouislider.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <!-- /STYLES -->
    <!-- SCRIPTS -->
    <script src="{{ url_for('static', filename='js/echarts.min.js')}}"></script>
    <script src="{{ url_for('static', filename='js/nouislider.js')}}"></script>
    <script src="{{ url_for('static', filename='js/vis.js')}}"></script>
    <script src="{{ url_for('static', filename='js/yc.js')}}"></script>
    <script src="{{ url_for('static', filename='js/dn.js')}}"></script>

    <!-- /SCRIPTS -->



</head>

<body>
    <div class="grid_container">
        <div id="network" class="network"></div>

        <div id="side" class="side">

            <label for="fname">lower:</label>
            <input type="text" id="input-lower" name="input-lower"><br><br>
            <label for="lname">upper:</label>
            <input type="text" id="input-upper" name="input-upper"><br><br>
            <br><br><br><br><br><br>
            <label for="lname">idx:</label>
            <input type="text" id="input-idx" name="input-idx"><br><br>

            <input type="radio" id="union" name="merge" onclick="unionRadio(this)" value="1" checked />
            <label for="union">union</label><br>
            <input type="radio" id="intersection" name="merge" onclick="unionRadio(this)" value="0">
            <label for="intersection">intersection</label><br>

            <br><br>
            <input type="checkbox" id="twoHandles" value="2"> 2 handles


        </div>
        <div id="range-slider-box" class="range-slider-box">
            <div id="range-slider" class="range-slider"></div>
        </div>

        <div id="timeline" class="timeline"></div>


    </div>


    <script>



        var union=true;
        function unionRadio(radioBtn){
            union = parseInt(radioBtn.value);
        }

        document.getElementById('twoHandles').onclick = function() {
            if ( this.checked ) {
                slider.updateHandles(2,line.dataZoomBoundary());
                
            } else {
                slider.updateHandles(1,line.dataZoomBoundary());
            }
            slider.bindNetwork(network);
        };


        var links = JSON.parse('{{ links | safe}}').map(u => ({ t: u.t, i: u.i, j: u.j }));
        var nodes = JSON.parse('{{ nodes | safe}}');

        var dn = DynamicNetwork()
        dn.addNodes(nodes)
        dn.addRelationships(links)

        const timeData = dn.getTimeline();
        const nrNodes = dn.getListNrOfVertices();
        const nrLinks = dn.getListNrOfEdges();
        const activeDensity = dn.getListActiveDensity();
        const disconnected = dn.getListNrOfdisconnected();
        const maxClique = dn.getListMaximumClique();


        var line = new vis.LineSummary('timeline')
        var network = new vis.Network('network')
        // setInterval(function(){
        //     network.increase()
        // },2000);


        // start and end are percentage
        function changeDataZoom(start, end) {
            start_q = yc.quantile(timeData, start)
            end_q = yc.quantile(timeData, end)
            option.dataZoom[0].start = start_q;
            option.dataZoom[0].end = end_q;
            myChart.setOption(option);
            vis.dataZoomScaleSlider(slider)
        }




        var slider = new vis.Slider('range-slider', line.dataZoomBoundary(),1)

        line.triggerSlider(slider);
        slider.bindNetwork(network);

        // var inputLower = document.getElementById('input-lower');
        // var inputUpper = document.getElementById('input-upper');

        // var inputs = [inputLower, inputUpper]

        // vis.bindSliderInputs(slider, inputs)


        // var tooltips = slider.noUiSlider.getTooltips();





        // var connect = slider.querySelectorAll('.noUi-connect');
        // var classes = ['c-1-color', 'c-2-color', 'c-3-color', 'c-4-color'];

        // for (var i = 0; i < connect.length; i++) {
        //     connect[i].classList.add(classes[i]);
        // }


        window.onresize = function () {
            line.resize();
            network.resize();
        }




    </script>


</body>

</html>